
# Основные сценарии использования Diplodoc

## Быстрый старт


{% note warning %}

Для работы с Diplodoc вам потребуются учетная запись на [GitHub](https://github.com/) и система контроля версий [Git](https://git-scm.com/downloads).

{% endnote %}


1. Перейдите на сайт [diplodoc.com](https://diplodoc.com/) и нажмите кнопку **Начать**.

2. Следуйте инструкции, указанной на странице. 

    <!-- Подробно описать инструкцию не получается, т. к. не смог заново инициировать процесс создания нового репозитория. -->

    На вашей странице GitHub будет автоматически создан репозиторий `diplodoc-example` и создана ссылка на пример документации.


{% note info %}

Чтобы изменить стандартное имя репозитория `diplodoc-example`, [свяжитесь с нами](https://diplodoc.com/#contact).

{% endnote %}


### Редактирование документа

1. Склонируйте репозиторий;

1. Cоздайте новую ветку и внесите изменения в файлы папки `docs`;

1. Сделайте пул-реквест.

   Сработает экшн `build-docs`, который создаст превью вашего документа. 

   <!-- Где посмотреть превью ПР? -->

После слияния вашей ветки с веткой `main`, пересоберите ваш документ. Для этого перейдите на вкладку **actions**, выберите экшн **release** и в верхнем правом углу нажмите кнопку  **Re-run all jobs**.

<!-- Этот раздел требует уточнения. Документ должен быть доступен по ссылке `<имя_пользователя_на_гитхабе>--viewer.diplodoc.com/en/`>, но такая ссылка не работает. -->

### Размещение документа на GitHub Pages

**Видеоинструкция**

@[YouTube](https://youtu.be/6j4egX9eY9I?t=7123)

1. В GitHub в репозитории вашего документа перейдите на вкладку **Settings**  и в меню слева выберите **Pages**.

1. В разделе **Build and deployment** в выпадающем списке выберите **GitHub Actions** и в появившемся блоке **Static HTML** нажмите кнопку **Configure**.  Откроется окно редактирования экшна.

1. В блоке `jobs` после строки `uses: actions/configure-pages@v5` добавьте код

    ```yaml
    - name: Build docs
      uses: diplodoc-platform/docs-build-action@v3
      with:
        src-root: './docs'
        build-root: './docs-html'
    ```


{% note info %}

В представленной выше [видеоинструкции](https://youtu.be/6j4egX9eY9I?t=7123) для параметра `build-root` указано значение `'./build'`. При такой настройке ссылка из п.5 будет выдавать ошибку 404.

{% endnote %}


1. Вверху справа нажмите **Commit changes...**, укажите имя коммита в поле **Commit message** и нажмите кнопку **Commit changes**.

1. Перейдите на вкладку **Actions**. Вверху списка будет ваш последний коммит. 

1. Нажмите на название коммита. После завершения сборки, документ будет размещен на GitHub Pages. Посмотреть его можно по ссылке ниже под надписью **deploy**.

## Создание простого документационного проекта в YFM 

### Структура проекта
Базовый проект состоит из нескольких конфигурационных файлов и страниц с контентом, связанных между собой в следующую структуру: 


```
input-folder
|-- .yfm (Файл конфигурации)
|-- toc.yaml (Оглавление)
|-- presets.yaml (Пресеты переменных)
|-- index.yaml (Разводящая страница)
|-- pages (Файлы с контентом)
    |-- faq.md
    |-- how-to.md
|-- _assets (Каталог с изображениями)
    |-- image1.png
    |-- image2.png
|-- _includes (Каталог с файлами для переиспользования)
    |-- faq_shared_block.md
```

Больше информации про параметры и конфигурацию можно найти в разделе [**Документационный проект**](./project/index.md). 

### Сборка проекта 

Сборка выполняется с помощью инструмента [**Builder**](tools/docs/index.md) в командной строке.

Чтобы запустить сборку, выполните команду, указав обязательные ключи запуска


-  input, -i — путь до директории проекта.


- output, -o — путь до директории, предназначенной для выходных данных (статических HTML).


#### Пример
```
yfm -i ./input-folder -o ./ouput-folder
```


### Результат 
После успешного выполнения работы сборщика появляется или готовый проект HTML или проект в YFM.
Часто вывод в YFM применяется для создания подразделов и включения в крупные проекты. 



### Использование 
Готовые проекты в HTML можно использовать локально или разместить на подходящем для Вас хостинге, включая S3-like хранилище.



## Интеграция в Ваш процесс разработки  
### Создание и построение проекта 

В общем случае структура проекта и процедуры построения не отличаются от описанного в предыдущей секции. 
Однако в случае интеграции с Вашими СI/CD пайплайнами требуется включение Builder для срабатывания по триггерам обновления документации в репозитории. 

Если при коммите в проекты, написанные на С++ или Java пайплайны вызывают определенные компиляторы, то для документации в таком случае 
роль “компилятор” берет на себя Builder. C его помощью генерируются артефакты, которые могут быть автоматически выложены на 
внутренние или внешние ресурсы для доступа конечных пользователей. 

### Подключение плагинов и расширенная конфигурация
Как правило, большие документационные проекты используют дополнительные возможности по работе с контентом и специфичные конфигурации для построения. 
Примером таких расширений является возможность работы с видео или многострочных таблиц.
Подробнее о способах корректного отображения и трансформации контента можно почитать на [странице](./plugins/index.md).

Особенностью конфигурации при построении может быть возможность отключения линтера или сборка проекта в виде одного большого html файла.
Дополнительно о таких возможностях можно ознакомиться на [странице](./tools/transform/settings.md).



## Работа с Github и публикация документов на своем домене или домене https://diplodoc.com 

Если Ваш проект использует Github как систему контроля версий и место хранения исходного кода Вашей документации, Diplodoc позволит создать полностью интегрированный пайплайн работы, покрывающий все шаги от внесения изменений в исходные тексты до построения проекта с помощью Github actions и интеграции с Elastic Search. 

[Свяжитесь с нами](https://diplodoc.com/#contact), чтобы обсудить детали Вашей конфигурации и возможные варианты решения.
